(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{616:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(5155),o=t(2115),s=t(6766),l=t(8893),n=t(8488),i=t(5358),c=t(5892),h=t(8508),d=t(5695);let g=()=>{let[e,r]=(0,o.useState)(null),[t,a]=(0,o.useState)(!0),[s,l]=(0,o.useState)(null),n=(0,d.useRouter)(),i=(0,o.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),r(null),n.push("/login")},[n]),c=(0,o.useCallback)(async()=>{try{if(!localStorage.getItem("token")){a(!1);return}try{let e=await (0,h.VM)();r(e)}catch(t){var e;if((e=>e instanceof Error&&"response"in e)(t)&&(null===(e=t.response)||void 0===e?void 0:e.status)===401)try{if(await (0,h.Be)()){let e=await (0,h.VM)();r(e)}else throw Error("Failed to refresh token")}catch(e){console.error("Token refresh failed:",e),l("Session expired. Please log in again."),i()}else throw t}}catch(e){console.error("Auth check failed:",e),l("Authentication failed"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}finally{a(!1)}},[i]);return(0,o.useEffect)(()=>{c()},[c]),{user:e,loading:t,error:s,logout:i,isAuthenticated:!!e,checkAuth:c}};var u=t(6191);let f=t.n(u)(),x=()=>{let{user:e,loading:r,error:t}=g();return r?(0,a.jsxs)(l.A,{sx:{mt:4},children:[(0,a.jsx)(n.A,{variant:"text",height:60,width:"50%"}),(0,a.jsx)(n.A,{variant:"rectangular",height:200,width:"100%",sx:{my:2}}),(0,a.jsxs)(l.A,{sx:{display:"flex",gap:2,my:2},children:[(0,a.jsx)(n.A,{variant:"rectangular",height:40,width:120}),(0,a.jsx)(n.A,{variant:"rectangular",height:40,width:120})]})]}):t?(0,a.jsxs)(l.A,{sx:{mt:4},children:[(0,a.jsxs)(i.A,{variant:"h5",color:"error",gutterBottom:!0,children:["Error: ",t]}),(0,a.jsx)(i.A,{children:"Please try refreshing the page or logging in again."})]}):(0,a.jsxs)(l.A,{sx:{mt:4},children:[(0,a.jsxs)(i.A,{variant:"h4",component:"h1",gutterBottom:!0,children:["Welcome ",e?"".concat(e.firstName||""," ").concat(e.lastName||""):"Guest"]}),(0,a.jsxs)("div",{className:f.main,children:[(0,a.jsx)(s.default,{className:f.logo,src:"/next.svg",alt:"Next.js logo",width:180,height:38,priority:!0}),(0,a.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"This is your dashboard. You can start building your application content here."}),(0,a.jsxs)("div",{className:f.ctas,children:[(0,a.jsxs)("a",{className:f.primary,href:"https://vercel.com/new",target:"_blank",rel:"noopener noreferrer","aria-label":"Deploy now on Vercel",children:[(0,a.jsx)(s.default,{src:"/vercel.svg",alt:"Vercel logomark",width:20,height:20}),"Deploy now"]}),(0,a.jsx)("a",{href:"https://nextjs.org/docs",target:"_blank",rel:"noopener noreferrer",className:f.secondary,"aria-label":"Read the Next.js documentation",children:"Read our docs"})]})]}),(0,a.jsxs)("footer",{className:f.footer,children:[(0,a.jsxs)("a",{href:"https://nextjs.org/learn",target:"_blank",rel:"noopener noreferrer","aria-label":"Learn Next.js",children:[(0,a.jsx)(s.default,{src:"/file.svg",alt:"File icon",width:16,height:16}),"Learn"]}),(0,a.jsxs)("a",{href:"https://vercel.com/templates",target:"_blank",rel:"noopener noreferrer","aria-label":"View Vercel templates",children:[(0,a.jsx)(s.default,{src:"/window.svg",alt:"Window icon",width:16,height:16}),"Examples"]}),(0,a.jsxs)("a",{href:"https://nextjs.org",target:"_blank",rel:"noopener noreferrer","aria-label":"Go to the Next.js website",children:[(0,a.jsx)(s.default,{src:"/globe.svg",alt:"Globe icon",width:16,height:16}),"Go to nextjs.org â†’"]})]})]})};function m(){return(0,a.jsx)(c.A,{children:(0,a.jsx)(o.Suspense,{fallback:(0,a.jsx)(n.A,{variant:"rectangular",height:400}),children:(0,a.jsx)(x,{})})})}},6191:e=>{e.exports={main:"page_main__xXfsr",logo:"page_logo__4wOtS",ctas:"page_ctas__Vxj5o",primary:"page_primary__9s1SN",secondary:"page_secondary__yGvUB",footer:"page_footer__8Ie1g"}},7477:(e,r,t)=>{Promise.resolve().then(t.bind(t,616))},8508:(e,r,t)=>{"use strict";t.d(r,{Be:()=>n,VM:()=>i,kz:()=>l});var a=t(3464);let o=a.A.create({baseURL:"http://localhost:8000",timeout:1e4}),s=e=>{e?o.defaults.headers.common.Authorization="Bearer ".concat(e):delete o.defaults.headers.common.Authorization},l=async(e,r,t)=>{try{let a=await o.post("/auth/registration/",{email:e,password1:r,password2:t});return a.data.access&&a.data.refresh&&(localStorage.setItem("token",a.data.access),localStorage.setItem("refreshToken",a.data.refresh),s(a.data.access)),a.data}catch(e){if(a.A.isAxiosError(e)){var l,n,i;throw console.error("Registration failed:",null===(l=e.response)||void 0===l?void 0:l.data),Error((null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.detail)||"Registration failed")}throw e}},n=async()=>{let e=localStorage.getItem("refreshToken");if(!e)return!1;try{let r=await o.post("/auth/token/refresh/",{refresh:e});if(r.data.access)return localStorage.setItem("token",r.data.access),s(r.data.access),!0;return!1}catch(e){return console.error("Token refresh failed:",e),!1}},i=async()=>{try{let e=localStorage.getItem("token");return e&&s(e),(await o.get("/profile/")).data}catch(r){if(console.error("Error fetching user profile:",r),a.A.isAxiosError(r)){var e;console.error("Axios Error:",r.message),console.error("Request Config:",r.config),console.error("Error Response:",null===(e=r.response)||void 0===e?void 0:e.data)}throw r}}}},e=>{var r=r=>e(e.s=r);e.O(0,[408,74,49,273,441,684,358],()=>r(7477)),_N_E=e.O()}]);